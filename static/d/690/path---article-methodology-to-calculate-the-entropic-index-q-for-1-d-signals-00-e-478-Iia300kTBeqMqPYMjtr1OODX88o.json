{"data":{"wordpressPost":{"title":"Methodology to Calculate the Entropic Index q for 1D Signals","content":"<html><head></head><body><p>The determination of the q index is often employed empirically and values that are proposed in literature are commonly the result of trial and error based on sufficiently good results. In this article, I will demonstrate an algorithmic procedural way to determine the q index reported in [1]. Although, the original procedure has been devised for image segmentation, a slight modification is conducted for our application in 1D signal processing. The procedure relies on the redundancy concept and maximum entropy principle, which basically constitutes to calculating the redundancy R_T as a function of entropic index q.</p>\n<p></p><div class=\" gatsby-image-wrapper\" style=\"position:relative;overflow:hidden;max-width:100%;width:300px\" data-reactroot><div style=\"width:100%;padding-bottom:11.021814006888635%\"></div><img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMABJPgAAST4AGIAg1vAAAANElEQVQI12NgYGAQAGJmIOYAYiYGCJADYi4G0gAjEPOCGBJAzAPlMEH5UlCLmEgwEKRWGABKBADgSq717AAAAABJRU5ErkJggg==\" alt style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s;transition-delay:0.25s\"><picture><img sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"/static/150c2928ff5547b828437e7a5e45fffa/c14e1/post5_eq1.png 75w,\n/static/150c2928ff5547b828437e7a5e45fffa/d4214/post5_eq1.png 150w,\n/static/150c2928ff5547b828437e7a5e45fffa/135ae/post5_eq1.png 300w,\n/static/150c2928ff5547b828437e7a5e45fffa/44727/post5_eq1.png 450w,\n/static/150c2928ff5547b828437e7a5e45fffa/34e8a/post5_eq1.png 600w,\n/static/150c2928ff5547b828437e7a5e45fffa/05040/post5_eq1.png 871w\" src=\"/static/150c2928ff5547b828437e7a5e45fffa/135ae/post5_eq1.png\" alt style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s\"></picture><noscript><picture><img sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"/static/150c2928ff5547b828437e7a5e45fffa/c14e1/post5_eq1.png 75w,\n/static/150c2928ff5547b828437e7a5e45fffa/d4214/post5_eq1.png 150w,\n/static/150c2928ff5547b828437e7a5e45fffa/135ae/post5_eq1.png 300w,\n/static/150c2928ff5547b828437e7a5e45fffa/44727/post5_eq1.png 450w,\n/static/150c2928ff5547b828437e7a5e45fffa/34e8a/post5_eq1.png 600w,\n/static/150c2928ff5547b828437e7a5e45fffa/05040/post5_eq1.png 871w\" src=\"/static/150c2928ff5547b828437e7a5e45fffa/135ae/post5_eq1.png\" alt=\"\" style=\"position:absolute;top:0;left:0;transition:opacity 0.5s;transition-delay:0.5s;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center\"/></picture></noscript></div><p></p>\n<p>Before delving into the methodology, I will provide a brief background on Tsallis entropy, as some of the theoretical equations S_T and S_{Tmax} are required in the procedure.</p>\n<h4><strong>Background</strong></h4>\n<p>The Tsallis entropy is given by equation (2):</p>\n<p></p><div class=\" gatsby-image-wrapper\" style=\"position:relative;overflow:hidden;max-width:100%;width:300px\" data-reactroot><div style=\"width:100%;padding-bottom:13.513513513513512%\"></div><img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMABJPgAAST4AGIAg1vAAAAQ0lEQVQI12NgQAAuIGZC4ssAMT8DGYAbapgIEEsAsSgQswCxEhCLAbEiEDMSaRbYQSDFvEAsAKWZoZKyQCyF5mqCAACpowFVBkRPfgAAAABJRU5ErkJggg==\" alt style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s;transition-delay:0.25s\"><picture><img sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"/static/9d2dfb28c17f5b3ddb5b83a411d4a979/c14e1/post5_eq2.png 75w,\n/static/9d2dfb28c17f5b3ddb5b83a411d4a979/d4214/post5_eq2.png 150w,\n/static/9d2dfb28c17f5b3ddb5b83a411d4a979/135ae/post5_eq2.png 300w,\n/static/9d2dfb28c17f5b3ddb5b83a411d4a979/44727/post5_eq2.png 450w,\n/static/9d2dfb28c17f5b3ddb5b83a411d4a979/34e8a/post5_eq2.png 600w,\n/static/9d2dfb28c17f5b3ddb5b83a411d4a979/fea0e/post5_eq2.png 900w,\n/static/9d2dfb28c17f5b3ddb5b83a411d4a979/a9c1d/post5_eq2.png 925w\" src=\"/static/9d2dfb28c17f5b3ddb5b83a411d4a979/135ae/post5_eq2.png\" alt style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s\"></picture><noscript><picture><img sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"/static/9d2dfb28c17f5b3ddb5b83a411d4a979/c14e1/post5_eq2.png 75w,\n/static/9d2dfb28c17f5b3ddb5b83a411d4a979/d4214/post5_eq2.png 150w,\n/static/9d2dfb28c17f5b3ddb5b83a411d4a979/135ae/post5_eq2.png 300w,\n/static/9d2dfb28c17f5b3ddb5b83a411d4a979/44727/post5_eq2.png 450w,\n/static/9d2dfb28c17f5b3ddb5b83a411d4a979/34e8a/post5_eq2.png 600w,\n/static/9d2dfb28c17f5b3ddb5b83a411d4a979/fea0e/post5_eq2.png 900w,\n/static/9d2dfb28c17f5b3ddb5b83a411d4a979/a9c1d/post5_eq2.png 925w\" src=\"/static/9d2dfb28c17f5b3ddb5b83a411d4a979/135ae/post5_eq2.png\" alt=\"\" style=\"position:absolute;top:0;left:0;transition:opacity 0.5s;transition-delay:0.5s;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center\"/></picture></noscript></div><p></p>\n<p>Where &#xA0;represents the total number of accessible microstates of system [1], each one with probability p_i, where 1\\leqi\\leq\\Omega with probabilities p_i, satisfy equation \\sum_{i=1}^{\\Omega}p_i=1. The number q is an entropic index that characterizes the degree of non-extensivity of the system. A system is considered non-extensive if it satisfies the equation S_{BG}(A+B) \\neq S_{BG}(A)+S_{BG}(B).</p>\n<p>Note:</p>\n<ol>\n<li>When \\lim_{q\\to\\infty}, S_T, the Tsallis entropy reduces back to the Boltzmann-Gibbs entropy or so called Shannon entropy.</li>\n<li>The maximum Tsallis entropy is obtained when each microstate is equilprobable, given by:</li>\n</ol>\n<p></p><div class=\" gatsby-image-wrapper\" style=\"position:relative;overflow:hidden;max-width:100%;width:300px\" data-reactroot><div style=\"width:100%;padding-bottom:11.555555555555557%\"></div><img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMABJPgAAST4AGIAg1vAAAAOklEQVQI143MsQ3AIBDF0M+JUABCJIAosv+euLgBsPRaS1KGISDiQ8GPF4/uMn9p+6S6jomFpvsSxgFZtQENrGzsOAAAAABJRU5ErkJggg==\" alt style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s;transition-delay:0.25s\"><picture><img sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"/static/fd2020030aadb74b32c4ae8f1cb4f6dd/c14e1/post5_eq3.png 75w,\n/static/fd2020030aadb74b32c4ae8f1cb4f6dd/d4214/post5_eq3.png 150w,\n/static/fd2020030aadb74b32c4ae8f1cb4f6dd/135ae/post5_eq3.png 300w,\n/static/fd2020030aadb74b32c4ae8f1cb4f6dd/44727/post5_eq3.png 450w,\n/static/fd2020030aadb74b32c4ae8f1cb4f6dd/34e8a/post5_eq3.png 600w,\n/static/fd2020030aadb74b32c4ae8f1cb4f6dd/fea0e/post5_eq3.png 900w\" src=\"/static/fd2020030aadb74b32c4ae8f1cb4f6dd/135ae/post5_eq3.png\" alt style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s\"></picture><noscript><picture><img sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"/static/fd2020030aadb74b32c4ae8f1cb4f6dd/c14e1/post5_eq3.png 75w,\n/static/fd2020030aadb74b32c4ae8f1cb4f6dd/d4214/post5_eq3.png 150w,\n/static/fd2020030aadb74b32c4ae8f1cb4f6dd/135ae/post5_eq3.png 300w,\n/static/fd2020030aadb74b32c4ae8f1cb4f6dd/44727/post5_eq3.png 450w,\n/static/fd2020030aadb74b32c4ae8f1cb4f6dd/34e8a/post5_eq3.png 600w,\n/static/fd2020030aadb74b32c4ae8f1cb4f6dd/fea0e/post5_eq3.png 900w\" src=\"/static/fd2020030aadb74b32c4ae8f1cb4f6dd/135ae/post5_eq3.png\" alt=\"\" style=\"position:absolute;top:0;left:0;transition:opacity 0.5s;transition-delay:0.5s;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center\"/></picture></noscript></div><p></p>\n<ul>\n<li>S_T will be maximum if q&gt;0, and S_T will be minimum if q&lt;0. If q\\geq1, S_T approaches \\frac{1}{q-1}, and if q\\leq1, S_T diverges to \\infty.</li>\n</ul>\n<h4><strong>Methodology</strong></h4>\n<ol>\n<li>Given a 1D signal, construct a histogram then perform normalisation by dividing by the area under the curve. Luckily, Matlab has a function to do this. Remove any probability points p_i that equal zero to remove redundancy.</li>\n<li>Calculate S_T and S_{Tmax} using equation 2 and 3, where \\Omega is the number of probability points in the histogram and q starting at for example -2,</li>\n<li>Using equation 1, calculate the redundancy R_T,</li>\n<li>Repeat steps 2 and 3, incrementing q value by 0.1 up to for example 10.</li>\n<li>Plot R_T versus q, and pick the q value that maximises R_T. Depending how your plot looks, you may have to adjust your q value range and increment size.</li>\n</ol>\n<h4>Code</h4>\n<pre class=\"line-numbers\" data-line=\"all\"><code class=\"language-matlab\">function q_best = optimalQ(x,nbins,k,minq, maxq, increq)\n\n%x = 1D signal, nbins = number of bins, k is usually 1\n%minq = minimum q value to start, maxq = maximum q value to end\n%increq = increment q value\n\n%normalise histogram\nh = histogram(x,nbins,&#x2019;normalisation&#x2019;,&#x2019;probability&#x2019;);\n%remove p = 0 points\nh1 = h.Data(h.Data~=0);\nc=1;\noutput = [];\nfor q=minq:increq:maxq\n\t [ST, ST_max] = tsallisE(h1,q,k);\n\tRT = 1-ST/ST_max;\n\toutput(c,1) = RT;\n\toutput(c,2) = q;\n\tc = c +1;\nend\n\n%find q that gives max RT\n[pks,loc] = findpeaks(output(:,1),output(:,2));\nIf isempty(loc)\n\terror(&#x2018;q range does not capture maxima&#x2019;);\nelse\n\tq_best = loc;\nend\nfunction [ST,ST_max] = tsallisE(h1,q,k)\n\tST = (k/(q-1))*(1-sum(h1.^q));\n\tST_max = k*(1-length(h1)^(1-q))/(q-1)</code></pre>\n<h4>Reference:</h4>\n<p>[1] Ramirez-Reyes, A., Herandez-Montoya, A.R., Herrera-Corral, G., Jimenez, I.D., 2016, Determining the entropic index q of Tsallis entropy in Images through redundancy, Entropy, 18 (8), 299</p>\n</body></html>","date":"2019-05-14T12:01:44.000Z","slug":"methodology-to-calculate-the-entropic-index-q-for-1d-signals","acf":{"readingDuration":"8 min","gist_text":null},"categories":[{"name":"Article"}],"featured_media":{"localFile":{"childImageSharp":{"fluid":{"src":"/static/429a62c8abcbb946a47d099356d495e5/c2a4f/entropyindexcover-01.png"}}}}},"site":{"siteMetadata":{"title":"JOHN PHUNG","description":"Researcher, Designer, Developer & Entrepreneur","author":"John Phung","url":"https://johnphung.tech","twitterHandle":"@jphungme"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"5075d41f-f3fe-5837-b1e6-28915825a105"}}