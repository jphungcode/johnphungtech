{"data":{"wordpressPost":{"title":"Selecting the best wavelet for decomposition using Shannon Entropy","content":"<html><head></head><body><p>Wavelet transform is a pretty awesome signal processing technique to extract time frequency data, however choosing the optimal wavelet to use and best decomposition level often leaves us scratching our heads. Our main intuition in selecting good parameters for wavelet transform often comes down to experience and prior information we have, such as interested frequency bands or similarity of signal shapes with wavelets. However, there are numerous journal papers outlining different approaches to extract these parameters.</p>\n<p>In this post, I will focus on best wavelet selection using Shannon Entropy outlined in a journal paper by Yang &amp; Wang (2015).</p>\n<p>The general procedure is as follows:</p>\n<ol>\n<li>Choose a range of wavelets to compare (e.g db1-8, bior, dmey, sym),</li>\n<li>Decompose signal into J levels using either wavelet transform or wavelet packer decomposition,</li>\n<li>For approximation and detail components, calculate the relative energy</li>\n<li>Determine the Shannon entropy using this equation<br>\n<div class=\" gatsby-image-wrapper\" style=\"position:relative;overflow:hidden;max-width:100%;width:300px\" data-reactroot><div style=\"width:100%;padding-bottom:11.625403659849301%\"></div><img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMABJPgAAST4AGIAg1vAAAAOUlEQVQI12NgYGDgg2J2BggAsYWAmBUqBqIZGYgDnCBCHIglgZgXiJmBWAJqkBhUXAbJMnyACYiFAVxYASWUqsDgAAAAAElFTkSuQmCC\" alt style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s;transition-delay:0.25s\"><picture><img sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"/static/842b22a5677bbaba6a17ccf193c861c3/c14e1/post1_eq1.png 75w,\n/static/842b22a5677bbaba6a17ccf193c861c3/d4214/post1_eq1.png 150w,\n/static/842b22a5677bbaba6a17ccf193c861c3/135ae/post1_eq1.png 300w,\n/static/842b22a5677bbaba6a17ccf193c861c3/44727/post1_eq1.png 450w,\n/static/842b22a5677bbaba6a17ccf193c861c3/34e8a/post1_eq1.png 600w,\n/static/842b22a5677bbaba6a17ccf193c861c3/fea0e/post1_eq1.png 900w,\n/static/842b22a5677bbaba6a17ccf193c861c3/356ef/post1_eq1.png 929w\" src=\"/static/842b22a5677bbaba6a17ccf193c861c3/135ae/post1_eq1.png\" alt style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s\"></picture><noscript><picture><img sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"/static/842b22a5677bbaba6a17ccf193c861c3/c14e1/post1_eq1.png 75w,\n/static/842b22a5677bbaba6a17ccf193c861c3/d4214/post1_eq1.png 150w,\n/static/842b22a5677bbaba6a17ccf193c861c3/135ae/post1_eq1.png 300w,\n/static/842b22a5677bbaba6a17ccf193c861c3/44727/post1_eq1.png 450w,\n/static/842b22a5677bbaba6a17ccf193c861c3/34e8a/post1_eq1.png 600w,\n/static/842b22a5677bbaba6a17ccf193c861c3/fea0e/post1_eq1.png 900w,\n/static/842b22a5677bbaba6a17ccf193c861c3/356ef/post1_eq1.png 929w\" src=\"/static/842b22a5677bbaba6a17ccf193c861c3/135ae/post1_eq1.png\" alt=\"\" style=\"position:absolute;top:0;left:0;transition:opacity 0.5s;transition-delay:0.5s;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center\"/></picture></noscript></div><br>\nwhere p_k = E^{i}_{J}/E_T (Relative Energy/Total Energy), N is the number of decomposed details.</li>\n<li>Calculate the Shannon entropy to total wavelet energy ratio<br>\n<div class=\" gatsby-image-wrapper\" style=\"position:relative;overflow:hidden;max-width:100%;width:300px\" data-reactroot><div style=\"width:100%;padding-bottom:11.294117647058824%\"></div><img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMABJPgAAST4AGIAg1vAAAANElEQVQI12NgYGAQBmIeIGYGYm4gVgFidSibFMAIxLwghiwQSwOxIBCzQNmSUAWkAJCDRABxOQErPKcDGQAAAABJRU5ErkJggg==\" alt style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s;transition-delay:0.25s\"><picture><img sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"/static/25c5635f5b9060631ec1b4e47fddafc6/c14e1/post1_eq2.png 75w,\n/static/25c5635f5b9060631ec1b4e47fddafc6/d4214/post1_eq2.png 150w,\n/static/25c5635f5b9060631ec1b4e47fddafc6/135ae/post1_eq2.png 300w,\n/static/25c5635f5b9060631ec1b4e47fddafc6/44727/post1_eq2.png 450w,\n/static/25c5635f5b9060631ec1b4e47fddafc6/34e8a/post1_eq2.png 600w,\n/static/25c5635f5b9060631ec1b4e47fddafc6/4d3f1/post1_eq2.png 850w\" src=\"/static/25c5635f5b9060631ec1b4e47fddafc6/135ae/post1_eq2.png\" alt style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s\"></picture><noscript><picture><img sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"/static/25c5635f5b9060631ec1b4e47fddafc6/c14e1/post1_eq2.png 75w,\n/static/25c5635f5b9060631ec1b4e47fddafc6/d4214/post1_eq2.png 150w,\n/static/25c5635f5b9060631ec1b4e47fddafc6/135ae/post1_eq2.png 300w,\n/static/25c5635f5b9060631ec1b4e47fddafc6/44727/post1_eq2.png 450w,\n/static/25c5635f5b9060631ec1b4e47fddafc6/34e8a/post1_eq2.png 600w,\n/static/25c5635f5b9060631ec1b4e47fddafc6/4d3f1/post1_eq2.png 850w\" src=\"/static/25c5635f5b9060631ec1b4e47fddafc6/135ae/post1_eq2.png\" alt=\"\" style=\"position:absolute;top:0;left:0;transition:opacity 0.5s;transition-delay:0.5s;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center\"/></picture></noscript></div></li>\n<li>Pick the wavelet with the highest ratio.<br>\n<div class=\" gatsby-image-wrapper\" style=\"position:relative;overflow:hidden;max-width:100%;width:300px\" data-reactroot><div style=\"width:100%;padding-bottom:4.717948717948718%\"></div><img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMABJPgAAST4AGIAg1vAAAAKUlEQVQI12NgYGAQB2I5IJYAYhkgFgJiXiCWBmJZIFYFYnkg5mIgDMQAPLEBJalEREoAAAAASUVORK5CYII=\" alt style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s;transition-delay:0.25s\"><picture><img sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"/static/bff22fa002f1bfda50a74323c0a6eba9/c14e1/post1_eq3.png 75w,\n/static/bff22fa002f1bfda50a74323c0a6eba9/d4214/post1_eq3.png 150w,\n/static/bff22fa002f1bfda50a74323c0a6eba9/135ae/post1_eq3.png 300w,\n/static/bff22fa002f1bfda50a74323c0a6eba9/44727/post1_eq3.png 450w,\n/static/bff22fa002f1bfda50a74323c0a6eba9/34e8a/post1_eq3.png 600w,\n/static/bff22fa002f1bfda50a74323c0a6eba9/fea0e/post1_eq3.png 900w,\n/static/bff22fa002f1bfda50a74323c0a6eba9/6b691/post1_eq3.png 975w\" src=\"/static/bff22fa002f1bfda50a74323c0a6eba9/135ae/post1_eq3.png\" alt style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s\"></picture><noscript><picture><img sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"/static/bff22fa002f1bfda50a74323c0a6eba9/c14e1/post1_eq3.png 75w,\n/static/bff22fa002f1bfda50a74323c0a6eba9/d4214/post1_eq3.png 150w,\n/static/bff22fa002f1bfda50a74323c0a6eba9/135ae/post1_eq3.png 300w,\n/static/bff22fa002f1bfda50a74323c0a6eba9/44727/post1_eq3.png 450w,\n/static/bff22fa002f1bfda50a74323c0a6eba9/34e8a/post1_eq3.png 600w,\n/static/bff22fa002f1bfda50a74323c0a6eba9/fea0e/post1_eq3.png 900w,\n/static/bff22fa002f1bfda50a74323c0a6eba9/6b691/post1_eq3.png 975w\" src=\"/static/bff22fa002f1bfda50a74323c0a6eba9/135ae/post1_eq3.png\" alt=\"\" style=\"position:absolute;top:0;left:0;transition:opacity 0.5s;transition-delay:0.5s;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center\"/></picture></noscript></div></li>\n</ol>\n<p>Let&#x2019;s go through the procedure step by step in Matlab.</p>\n<p><strong>1. Choose a range of wavelets to compare</strong></p>\n<pre class=\"line-numbers\" data-line=\"1-9\" data-start=\"1\"><code class=\"language-matlab\">ratio = {}; \nwav_type ={&apos;db1&apos;,&apos;db2&apos;,&apos;db3&apos;,&apos;db4&apos;,&apos;db5&apos;,&apos;db6&apos;,&apos;db7&apos;,&apos;db8&apos;,&apos;db9&apos;,&apos;db10&apos;,... \n&apos;coif1&apos;,&apos;coif2&apos;,&apos;coif3&apos;,&apos;coif4&apos;,&apos;coif5&apos;,... \n&apos;sym1&apos;,&apos;sym2&apos;,&apos;sym3&apos;,&apos;sym4&apos;,&apos;sym5&apos;,&apos;sym6&apos;,&apos;sym7&apos;,&apos;sym8&apos;,... \n&apos;bior1.3&apos;,&apos;bior1.5&apos;,&apos;bior2.2&apos;,&apos;bior2.4&apos;,&apos;bior2.6&apos;,&apos;bior2.8&apos;,... \n&apos;bior3.1&apos;,&apos;bior3.3&apos;,&apos;bior3.5&apos;,&apos;bior3.7&apos;,&apos;bior3.9&apos;,&apos;bior4.4&apos;,&apos;bior6.8&apos;,...\n&apos;dmey&apos;};\n</code></pre>\n<p><strong>2. Decompose signal into J levels using wavelet packet decomposition</strong></p>\n<pre class=\"line-numbers\" data-line=\"all\"><code class=\"language-matlab\">signal = signal1.mat; %You will set your own signal data file level = 5; \n%Choose the appropriate decomposition level based on your data\nnodeind = 0:2^level-2^(level-1)-1; %node index for wavelet tree for \nk=1:size(wavelet,2) \nwpt = wpdec(signal,level, wavelet{k}, &apos;shannon&apos;);</code></pre>\n<p><strong>3. Calculate relative energy for each detail component</strong></p>\n<pre class=\"line-numbers\" data-line=\"all\"><code class=\"language-matlab\">E = [];\npk = [];\n  for i = 1:length(nodeind) \n    wp_detail = wpcoef(wpt, [level, nodeind(i)]); \n    E(i) = sum(abs(wp_detail).^2);\n  end    \nEt = sum(E);\n</code></pre>\n<p><strong>4. Determine shannon entropy for this level using relative energy</strong></p>\n<pre class=\"line-numbers\" data-line=\"all\"><code class=\"language-matlab\">pk = E./Et;\nshannon_entropy =  -sum(pk*log(pk)&apos;);\n</code></pre>\n<p><strong>5. Calculate Shannon Entropy to Total Energy Ratio</strong></p>\n<pre class=\"line-numbers\" data-line=\"all\"><code class=\"language-matlab\">ratio(k,1) = Et/shannon_entropy;\nratio(k,2) = wavelet{k}; \n</code></pre>\n<p><strong>6.&#xA0; Pick wavelet with highest ratio</strong></p>\n<pre class=\"line-numbers\" data-line=\"all\"><code class=\"language-matlab\">%Sort from largest to smallest\ntemp_sort = sortrows(ratio,1);\nbest_wavelet = temp{end,2};\n</code></pre>\n<p><strong>References:</strong><br>\nYang, Q., Wang, J., 2015, Multi-level Wavelet Shannon Entropy-Based Method for Single-Sensor Fault Location, Entropy, Vol.17, pp.7101-7117</p>\n</body></html>","date":"2019-03-25T06:58:49.000Z","slug":"hello-world-2","acf":{"readingDuration":"5 min","gist_text":null},"categories":[{"name":"Article"}],"featured_media":{"localFile":{"childImageSharp":{"fluid":{"src":"/static/9ff2c49f442d5e1d303f6b9e06ff0ec2/c2a4f/waveletentropycover.png"}}}}},"site":{"siteMetadata":{"title":"JOHN PHUNG","description":"Researcher, Designer, Developer & Entrepreneur","author":"John Phung","url":"https://johnphung.tech","twitterHandle":"@jphungme"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"177c801c-6dd2-5151-9a16-caf3f65b949e"}}