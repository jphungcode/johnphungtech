{"data":{"wordpressPost":{"title":"Signal feature extraction using Short Time Fourier Transform, Singular Value Decomposition and Maximum Entropy","content":"<html><head></head><body><p>Interpreting signals is often a gruelling task, let alone trying to find a new or fancy way to do it, but that&#x2019;s life in research so can&#x2019;t complain there. In this post, I will demonstrate a novice approach to analysing and extracting meaningful features from multi component signals to either quantify or feed into a machine learning technique.</p>\n<p>This approach comprises of three steps, each which can be replaced by a more advanced technique to extract better results, maybe&#x2026;</p>\n<h4>Perform time frequency analysis on signal data</h4>\n<p>For this demonstration, I will utilise Short Time Fourier Transform (STFT) squared magnitude or spectrogram for time frequency representation which is denoted by:</p>\n<p></p><div class=\" gatsby-image-wrapper\" style=\"position:relative;overflow:hidden;max-width:100%;width:300px\" data-reactroot><div style=\"width:100%;padding-bottom:9.674418604651162%\"></div><img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMABJPgAAST4AGIAg1vAAAAP0lEQVQI13XNSQoAIAxD0SxUFGfvf1iz+EstPCihgyQd2zYt0jcsK5as2iB7VbAuFjvDmQeVbJJFDgfmfwfbBX3SAVg5oGhMAAAAAElFTkSuQmCC\" alt style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s;transition-delay:0.25s\"><picture><img sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"/static/42abe175349e04b930dfe1fb24dd1568/c14e1/post4_eq1.png 75w,\n/static/42abe175349e04b930dfe1fb24dd1568/d4214/post4_eq1.png 150w,\n/static/42abe175349e04b930dfe1fb24dd1568/135ae/post4_eq1.png 300w,\n/static/42abe175349e04b930dfe1fb24dd1568/44727/post4_eq1.png 450w,\n/static/42abe175349e04b930dfe1fb24dd1568/34e8a/post4_eq1.png 600w,\n/static/42abe175349e04b930dfe1fb24dd1568/fea0e/post4_eq1.png 900w,\n/static/42abe175349e04b930dfe1fb24dd1568/e7ad5/post4_eq1.png 1075w\" src=\"/static/42abe175349e04b930dfe1fb24dd1568/135ae/post4_eq1.png\" alt style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s\"></picture><noscript><picture><img sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"/static/42abe175349e04b930dfe1fb24dd1568/c14e1/post4_eq1.png 75w,\n/static/42abe175349e04b930dfe1fb24dd1568/d4214/post4_eq1.png 150w,\n/static/42abe175349e04b930dfe1fb24dd1568/135ae/post4_eq1.png 300w,\n/static/42abe175349e04b930dfe1fb24dd1568/44727/post4_eq1.png 450w,\n/static/42abe175349e04b930dfe1fb24dd1568/34e8a/post4_eq1.png 600w,\n/static/42abe175349e04b930dfe1fb24dd1568/fea0e/post4_eq1.png 900w,\n/static/42abe175349e04b930dfe1fb24dd1568/e7ad5/post4_eq1.png 1075w\" src=\"/static/42abe175349e04b930dfe1fb24dd1568/135ae/post4_eq1.png\" alt=\"\" style=\"position:absolute;top:0;left:0;transition:opacity 0.5s;transition-delay:0.5s;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center\"/></picture></noscript></div><p></p>\n<p>Where x(t) is the signal under consideration, w(t) is a window function, tau is the time lag and X(tau,w) is the Fourier transform of the function x(t)w(t-tau).</p>\n<p>SFTF is obtained by taking the Discrete Fourier Transform/ Fast Fourier Transform at successive time windows. STFT provides a linear representation of time-frequency that can result in poor frequency resolution if window lengths are too small, but it is suffice for this demo. There are more advanced time frequency techniques that can be employed here such as Wigner-Ville Distribution (WVD), Smoothed WVD, Choi-Williams Distribution et al.</p>\n<h4>Perform Singular Value Decomposition (SVD) on time frequency matrix to extract singular diagonal matrix</h4>\n<p>Singular value decomposition represents a method that transforms the original correlated variables into uncorrelated set of variables [1]. It is commonly used in signal processing to remove noise by zeroing the small singular values. In this context, SVD is utilised to reduce dimensionality of the time frequency matrix and represent it in a vector with a rank matrix consisting of largest to smallest contributions.</p>\n<p>For a certain matrix S, the SVD is defined as follows:</p>\n<p></p><div class=\" gatsby-image-wrapper\" style=\"position:relative;overflow:hidden;max-width:100%;width:300px\" data-reactroot><div style=\"width:100%;padding-bottom:6.609547123623011%\"></div><img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMABJPgAAST4AGIAg1vAAAAH0lEQVQI12NgYGCQAGJeIJYCYhUgFgRiJgbSAQfIDAAgJQCZGJi2/QAAAABJRU5ErkJggg==\" alt style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s;transition-delay:0.25s\"><picture><img sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"/static/7f336478ef8e6aa1b7ab2da704c14bce/c14e1/post4_eq2.png 75w,\n/static/7f336478ef8e6aa1b7ab2da704c14bce/d4214/post4_eq2.png 150w,\n/static/7f336478ef8e6aa1b7ab2da704c14bce/135ae/post4_eq2.png 300w,\n/static/7f336478ef8e6aa1b7ab2da704c14bce/44727/post4_eq2.png 450w,\n/static/7f336478ef8e6aa1b7ab2da704c14bce/34e8a/post4_eq2.png 600w,\n/static/7f336478ef8e6aa1b7ab2da704c14bce/72501/post4_eq2.png 817w\" src=\"/static/7f336478ef8e6aa1b7ab2da704c14bce/135ae/post4_eq2.png\" alt style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s\"></picture><noscript><picture><img sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"/static/7f336478ef8e6aa1b7ab2da704c14bce/c14e1/post4_eq2.png 75w,\n/static/7f336478ef8e6aa1b7ab2da704c14bce/d4214/post4_eq2.png 150w,\n/static/7f336478ef8e6aa1b7ab2da704c14bce/135ae/post4_eq2.png 300w,\n/static/7f336478ef8e6aa1b7ab2da704c14bce/44727/post4_eq2.png 450w,\n/static/7f336478ef8e6aa1b7ab2da704c14bce/34e8a/post4_eq2.png 600w,\n/static/7f336478ef8e6aa1b7ab2da704c14bce/72501/post4_eq2.png 817w\" src=\"/static/7f336478ef8e6aa1b7ab2da704c14bce/135ae/post4_eq2.png\" alt=\"\" style=\"position:absolute;top:0;left:0;transition:opacity 0.5s;transition-delay:0.5s;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center\"/></picture></noscript></div><p></p>\n<p>Where Sigma is a diagonal singular matrix of the same size as S, and the values are sorted in decreasing order along the main diagonal. U and V are orthonormal matrices whose columns represent left and right singular vectors, respectively.</p>\n<h4>Perform entropy calculation on the singular value matrix</h4>\n<p>Entropy is the representation of future uncertainty by previous probability outcomes. In an event when received signal matches what is likely or highly probable, the entropy value is close to zero, whereas unpredictable signals will assume high entropy values with a maximum value corresponding to a 50% likelihood event.</p>\n<p>If the average amount of information we receive per signal increases determined by Eq.2, it signifies an increase in uncertainty due to a shift in the underlying probability distribution from the previous state to the current state. In other words, the previous received signal contains a different distribution then the current received signal, indicative of a change in the medium, transmitter or receiver.</p>\n<p></p><div class=\" gatsby-image-wrapper\" style=\"position:relative;overflow:hidden;max-width:100%;width:300px\" data-reactroot><div style=\"width:100%;padding-bottom:6.900328587075575%\"></div><img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMABJPgAAST4AGIAg1vAAAAJUlEQVQI12NgYGCQBmIuIGYFYg0gFgBicSCWhcrxMRAHmIFYDAAtgQDZ3gf2hwAAAABJRU5ErkJggg==\" alt style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s;transition-delay:0.25s\"><picture><img sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"/static/15d52682beaec496562e1e24e7eaa2b5/c14e1/post4_eq3.png 75w,\n/static/15d52682beaec496562e1e24e7eaa2b5/d4214/post4_eq3.png 150w,\n/static/15d52682beaec496562e1e24e7eaa2b5/135ae/post4_eq3.png 300w,\n/static/15d52682beaec496562e1e24e7eaa2b5/44727/post4_eq3.png 450w,\n/static/15d52682beaec496562e1e24e7eaa2b5/34e8a/post4_eq3.png 600w,\n/static/15d52682beaec496562e1e24e7eaa2b5/fea0e/post4_eq3.png 900w,\n/static/15d52682beaec496562e1e24e7eaa2b5/bf005/post4_eq3.png 913w\" src=\"/static/15d52682beaec496562e1e24e7eaa2b5/135ae/post4_eq3.png\" alt style=\"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s\"></picture><noscript><picture><img sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"/static/15d52682beaec496562e1e24e7eaa2b5/c14e1/post4_eq3.png 75w,\n/static/15d52682beaec496562e1e24e7eaa2b5/d4214/post4_eq3.png 150w,\n/static/15d52682beaec496562e1e24e7eaa2b5/135ae/post4_eq3.png 300w,\n/static/15d52682beaec496562e1e24e7eaa2b5/44727/post4_eq3.png 450w,\n/static/15d52682beaec496562e1e24e7eaa2b5/34e8a/post4_eq3.png 600w,\n/static/15d52682beaec496562e1e24e7eaa2b5/fea0e/post4_eq3.png 900w,\n/static/15d52682beaec496562e1e24e7eaa2b5/bf005/post4_eq3.png 913w\" src=\"/static/15d52682beaec496562e1e24e7eaa2b5/135ae/post4_eq3.png\" alt=\"\" style=\"position:absolute;top:0;left:0;transition:opacity 0.5s;transition-delay:0.5s;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center\"/></picture></noscript></div><p></p>\n<p>Where p_k is Sigma_i/Sigma_T</p>\n<p>The Matlab code to perform this algorithmic approach is as follows:</p>\n<pre class=\"line-numbers\" data-line=\"all\"><code class=\"language-matlab\">function Sentropy = SSVD(signal, window, fs)\n%enter your data inputs checks here\nnfft = 2^nextpow2(length(signal));\n[s, f, t, ps] = spectrogram(signal, window, [], nfft, fs, &#x2018;psd&#x2019;, &#x2018;yaxis&#x2019;);\nsm = svd(ps);\nsumsv = sum(sv);\npk = sv./sumsv;\nSentropy = -sum(pk.*log(pk));\nend</code></pre>\n<p>It is quite straightforward to implement in Matlab or python. This approach extracts the most significant feature variables from a time frequency analysis that alone yield substantial amounts of signal information. It provides a robust way to perform signal change quantification using either entropy values itself, determining root mean squared errors or applying it to machine learning techniques.</p>\n<h4>References:</h4>\n<p>Orovic, I., Stankovic, S., Draganic, A., Time-frequency analysis and singular value decomposition applied to the highly multicomponent musical signals, Faculty of Electrical Engineering, University of Montengero, Montenegro</p>\n</body></html>","date":"2019-05-11T09:19:53.000Z","slug":"signal-feature-extraction-using-short-time-fourier-transform-singular-value-decomposition-and-maximum-entropy","acf":{"readingDuration":"10 min","gist_text":null},"categories":[{"name":"Article"}],"featured_media":{"localFile":{"childImageSharp":{"fluid":{"src":"/static/2d832683a379067be5e6ee46e0dea9e8/c2a4f/svdentropycover-01-01.png"}}}}},"site":{"siteMetadata":{"title":"JOHN PHUNG","description":"Researcher, Designer, Developer & Entrepreneur","author":"John Phung","url":"https://johnphung.tech","twitterHandle":"@jphungme"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"f4784a32-2395-5404-bfae-e62aac074a4c"}}